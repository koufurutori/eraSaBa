;-------------------------------------------------
;신장·체중·3 사이즈의 표시 처리
;-------------------------------------------------
;BASE:20…신장
;BASE:21…체중
;BASE:22…가슴
;BASE:23…웨스트
;BASE:24…히프
;MAXBASE:20…신장 계수
;MAXBASE:21…체중 계수
;MAXBASE:22…가슴 계수
;MAXBASE:23…웨스트 계수
;MAXBASE:24…히프 계수

@MAKE_SIZE, ARG
;신체 측정 플래그가 서 있는 경우는 계수를 생성
;신체 측정필 또한 미설정의 경우도 생성
;CSV에 기입되어 있지 않은 경우의 표준치는 1000
VARSET LOCAL


;===신장의 산출===
;기본치
BASE:ARG:신장 = (TALENT:ARG:성별 == 2) ? 1700 # 1500
BASE:ARG:신장 = BASE:ARG:신장 * MAXBASE:ARG:신장 / 1000

;체형 보정
IF TALENT:ARG:체형 == -2
	TIMES BASE:ARG:신장, 0.80
ELSEIF TALENT:ARG:체형 == -1
	TIMES BASE:ARG:신장, 0.90
ELSEIF TALENT:ARG:체형 == 1
	TIMES BASE:ARG:신장, 1.10
ELSEIF TALENT:ARG:체형 == 2
	TIMES BASE:ARG:신장, 1.20
ELSEIF TALENT:ARG:체형 == 3
	TIMES BASE:ARG:신장, 1.50
ENDIF

;===웨스트의 산출===
;기본치
BASE:ARG:웨스트 = BASE:ARG:신장 * 40 / 100
BASE:ARG:웨스트 = BASE:ARG:웨스트 * MAXBASE:ARG:웨스트 / 1000

;체형 보정
IF TALENT:ARG:체형 == -2
	TIMES BASE:ARG:웨스트, 1.16
ELSEIF TALENT:ARG:체형 == -1
	TIMES BASE:ARG:웨스트, 1.08
ENDIF

;그 외 보정
SIF TALENT:ARG:매력
	TIMES BASE:ARG:웨스트, 0.95

;===가슴의 산출===
;기본치
BASE:ARG:가슴 = BASE:ARG:신장 * 51 / 100
BASE:ARG:가슴 = BASE:ARG:가슴 * MAXBASE:ARG:가슴 / 1000

;가슴 사이즈 보정
IF TALENT:ARG:가슴사이즈 == -2
	TIMES BASE:ARG:가슴, 0.84
ELSEIF TALENT:ARG:가슴사이즈 == -1
	TIMES BASE:ARG:가슴, 0.92
ELSEIF TALENT:ARG:가슴사이즈 == 1
	TIMES BASE:ARG:가슴, 1.08
ELSEIF TALENT:ARG:가슴사이즈 == 2
	TIMES BASE:ARG:가슴, 1.16
ENDIF

;B감각에 의한 보정
BASE:ARG:가슴 = BASE:ARG:가슴 * (1000 + MIN(ABL:ARG:B감각, 100)) / 1000

;그 외 보정
SIF TALENT:ARG:매력
	TIMES BASE:ARG:가슴, 1.05

;언더 가슴 이하라면 보정
BASE:ARG:가슴 = MAX(BASE:ARG:신장 * 43 / 100, BASE:ARG:가슴)

;===히프의 산출===
;기본치
BASE:ARG:히프 = BASE:ARG:신장 * 53 / 100
BASE:ARG:히프 = BASE:ARG:히프 * MAXBASE:ARG:히프 / 1000

;그 외 보정
SIF TALENT:ARG:매력
	TIMES BASE:ARG:히프, 1.05

;===체중의 산출===
;기본치
BASE:ARG:체중 = BASE:ARG:신장 * BASE:ARG:신장 / 5000
BASE:ARG:체중 = BASE:ARG:체중 * MAXBASE:ARG:체중 / 1000

;체형 보정
IF TALENT:ARG:체형 == -2
	TIMES BASE:ARG:체중, 0.80
ELSEIF TALENT:ARG:체형 == -1
	TIMES BASE:ARG:체중, 0.90
ELSEIF TALENT:ARG:체형 == 1
	TIMES BASE:ARG:체중, 1.10
ELSEIF TALENT:ARG:체형 == 2
	TIMES BASE:ARG:체중, 1.20
ELSEIF TALENT:ARG:체형 == 3
	TIMES BASE:ARG:체중, 1.50
ELSEIF TALENT:ARG:체형 == 5
	TIMES BASE:ARG:체중, 10.00
ENDIF

;그 외 보정
SIF TALENT:ARG:매력
	TIMES BASE:ARG:체중, 0.95

@SHOW_SIZE, ARG
#DIM L_PENIS,20 ; P사이즈 계산용
;LOCAL:21…임신시의 체중의 계산치
;LOCAL:23…임신시의 웨스트의 계산치
VARSET LOCAL

	PRINTL
	PRINT □ 
	CALL PRINTBUTTON_EX("사이즈",160,TFLAG:160)
	PRINTL  □------------------------------------------------------------------------
	IF !TFLAG:사이즈표시
		;플레이어의 신장·체중은 불명
		IF ARG == NO:0 && TALENT:ARG:성별 == 2
			PRINTFORM  신장:???cm  체중:??kg
		ELSE
			;신장
			CALL ShowScaleInCM(ARG, BASE:ARG:신장, "신장:")
			;체중
			;소인의 체중은 1/10^3
			PRINTFORML    체중:{BASE:ARG:체중 / 10}. {BASE:ARG:체중 % 10}\@ TALENT:ARG:체형 == -5? g# kg\@
		ENDIF
		;[남자]가 아닌 플레이어는 비표시는 아니고 불명
		IF TALENT:ARG:성별 != 2
			;가슴
			CALL ShowScaleInCM(ARG, BASE:ARG:가슴, "   Ｂ:")
				PRINTFORM %LOCALS:0%
			CALL PRINT_CUPSIZE , ARG
			;웨스트
			CALL ShowScaleInCM(ARG, BASE:ARG:웨스트, "/ Ｗ:")
			PRINTFORM /
			;히프
			CALL ShowScaleInCM(ARG, BASE:ARG:히프, "/ H:")
				PRINTFORML 
			
		ENDIF
	ENDIF

PRINTL



@PRINT_CUPSIZE, ARG
;가슴의 컵 사이즈 생성
SPLIT "(-) ,(AAA) ,(AA) ,(A) ,(B) ,(C) ,(D) ,(E) ,(F) ,(G) ,(H) ,(I) ,(J) ,(K) ,(L) ,(M) ,(N) ,(O) ,(P) ,(Q) ,(R) ,(S) ,(T) ,(U) ,(V) ,(W) ,(X) ,(Y) ,(Z) ,(Z+) ,(규격외) ",",",LOCALS
;기본치
LOCAL = (BASE:ARG:가슴 - (BASE:ARG:신장 * 43 / 100)) / 25

;소인은 1/10
SIF TALENT:ARG:체형 == -5
	TIMES LOCAL, 0.10

;캐릭터라인 변수가 약간 부자유스러운 것으로 억지로 작성
LOCAL = LIMIT(LOCAL, 0, 30)
LOCALS:0 = %LOCALS:(LOCAL)%
PRINTFORM %LOCALS:0%



@ShowScaleInCM(C_ID, SIZE, ARGS)
#DIM C_ID
#DIM SIZE

PRINTFORM %ARGS%
IF TALENT:C_ID:체형 == -5
	PRINTFORM {SIZE / 100}.{SIZE % 100 / 10}{SIZE % 10}cm
ELSE
	PRINTFORM {SIZE / 10}.{SIZE % 10}cm
ENDIF